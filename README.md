## Abstract 
Network inference from time-series proteomics data remains a challenge in systems biology, with most approaches unable to distinguish direct regulatory relationships from indirect associations mediated by intermediate proteins. CausalEdge addresses this challenge by combining Granger Causality testing with bootstrapped mediation analysis to construct directed causal networks representing direct regulatory relationships. This model operates though a four-stage pipeline: 
- First, CausalEdge performs initial filtering to find protein pairs that vary together, which narrows down candidate pairs for testing.
- Second, it performs Granger Causality tests for each candidate pair to determine if past values of Protein $A$ help predict future values of Protein $B$ better than Protein $B$'s history alone, establishing temporal precedence with false discovery rate correction.
- Third, it builds a directed network graph where proteins are represented as nodes and directed edges represent causal relationships, with edges indicating where protein A positively or negatively causally influences changes in protein $B$.
- Fourth, it performs mediation analysis to determine is observed causal relationships are mediated by another intermediate variable. For example, if protein $A$ causally influecned both protein $B$ and $C$, and protein $B$ causally influences protein $C$, it's possible that protein $A$'s effect on protein $C$ is indirect and mediated by protein $B$. In these cases, conditional Granger Causality tests are performed to assess whether the $A$→$C$ relationship becomes non-signficant when controlling for $B$, and if so, the edge between nodes $A$ and $C$ is pruned.

By quantifying the proportion of causal effect mediatd using bootstrap confidence intervals, CausalEdge provides statistically rigorous identification of spurious edges, yielding clearner, high confidence, networks that more accurately reflect direct regulatory relationships. This model is applicable to time-series proteomics data from from traditional high-throughput platforms and emerging wearable molecular biosensors, enabling more interpretable systems-level analysis of protein regulatory dynamics. An important application of CausalEdge is generating condition-specific or subject-specific causal relationship data that can be integrated into biological knowledge graphs. This capability helps address the challenge of [molecular moonlighting](https://sequenceanddestroy.substack.com/p/molecular-moonlighting), where a given protein's function depends on context, by explicitly capturing how protein regulatory roles vary across different biological states.

## I. Introduction 
### 1.1 The Challenge of Network Inference in Proteomics
Understanding causal and regulatory relationships among proteins is fundamental to systems biology, with applications ranging from disease mechanism elucidation to therapeutic target identification. While high-throughput proteomics technologies have enabled comprehensive measurement of protein abundance across conditions and time points, inferring the underlying regulatory network structure remains challenging. Traditional approaches based on correlation or differential expression analysis can identify co-varying proteins but cannot establish distinguish direct regulatory relationships from indirect associations [1,2].

The distinction between direct and indirect relationships has important implications for biological interpretation. Consider a scenario where protein A regulates protein B, and protein B in turn regulates protein C (A→B→C). Standard network inference methods would typically report edges for A→B, B→C, and A→C. However, the A→C relationship is indirect, mediated entirely through B. Including such indirect edges in network representations obscures the true regulatory architecture, complicates hub identification, and can mislead downstream pathway analysis and therapeutic targeting efforts [3,4].

A related challenge in proteomics is molecular moonlighting; the phenomenon where individual proteins perform different functions depending on cellular context, localization, post-translational modifications, or disease state [24,25]. Static protein interaction databases cannot capture this context-dependence, making it difficult to understand what a specific protein is actually doing in a particular biological condition. Condition-specific causal networks that explicitly represent how protein regulatory relationships vary across contexts provide a solution to this problem, enabling more accurate functional annotation and better integration with biological knowledge graphs.

### 1.2 Limitations of Existing Approaches 
The landscape of network inference methods reveals a persistent gap between what we can measure and what we need to understand. Static correlation-based methods, including partial correlation networks and Gaussian graphical models, excel at identifying conditional independence relationships but lack the temporal information necessary to infer directionality [5,6]. Without knowing which protein's change precedes the other, these methods cannot distinguish regulatory drivers from their downstream targets, nor can they identify mediated relationships that require temporal ordering to detect.

Differential network analysis approaches have emerged to compare networks across conditions, offering insights into context-specific associations [7]. However, these methods inherit the same causal inference limitations as their static counterparts. While they can identify which associations differ between conditions, they cannot determine whether observed changes represent direct regulatory mechanisms or merely downstream consequences of upstream perturbations. This ambiguity becomes particularly problematic when attempting to identify therapeutic targets, where distinguishing between drivers and passengers is critical.

Bayesian network approaches offer a more sophisticated framework, capable of inferring directed acyclic graphs that have been successfully applied to gene expression data [8,9]. These methods can model probabilistic dependencies and infer directionality under certain assumptions. However, most implementations do not explicitly test for or remove mediated edges, treating all inferred dependencies as equally direct. Additionally, the computational complexity of Bayesian network inference scales poorly beyond a few hundred variables, making application to proteome-scale datasets, which may include thousands of proteins, challenging. Dynamic Bayesian networks extend this framework to temporal data but rarely incorporate explicit mediation testing [10], leaving the indirect relationship problem unresolved.

Information-theoretic methods, such as mutual information and transfer entropy, provide another avenue for network inference [11,12]. These approaches can capture nonlinear relationships and infer directionality without assuming specific functional forms, making them attractive for biological systems where regulatory mechanisms may be complex. However, reliable estimation of information-theoretic quantities requires substantial amounts of data—often more than typical proteomics experiments provide. Furthermore, these methods lack straightforward frameworks for statistical significance testing and multiple comparison correction, making it difficult to distinguish true regulatory relationships from noise in finite samples. The absence of established mediation analysis procedures within the information-theoretic framework further limits their ability to identify direct relationships.

Granger causality, originally developed in econometrics and now widely used in neuroscience, offers a complementary approach based on temporal precedence and predictive power [13,14]. The core idea is as follows: if past values of variable X improve prediction of variable Y beyond what Y's own history provides, then X can be said to "Granger-cause" Y. This operational definition of causality aligns well with regulatory biology, where upstream proteins influence the abundance or activity of downstream targets over time. Despite these advantages, applications of Granger causality to proteomics have been limited [15,16], and existing implementations have not addressed the fundamental problem of indirect relationships. When protein A regulates B, and B regulates C, standard Granger causality will detect both the direct relationships (A→B, B→C) and the indirect relationship (A→C), leaving researchers with cluttered networks that obscure the true regulatory architecture.

### 1.3 Novel Contributions 
The persistent challenge of distinguishing direct from indirect relationships in protein regulatory networks motivated the development of CausalEdge, a framework that integrates Granger causality testing with bootstrapped mediation analysis to systematically identify and remove spurious edges. This integration addresses a critical gap: while Granger causality establishes temporal precedence and predictive relationships, it does not inherently distinguish whether A→C represents a direct regulatory mechanism or an indirect effect mediated through intermediate proteins. By explicitly testing for mediation and quantifying the proportion of each relationship that operates through intermediates, CausalEdge enables data-driven decisions about which edges represent direct regulatory mechanisms.

The framework makes several advances beyond existing approaches. Rather than relying on arbitrary topology-based heuristics to prune networks (such as removing edges below a certain correlation threshold or keeping only the top-k strongest relationships), CausalEdge employs statistical hypothesis testing at every stage. Initial Granger causality tests are corrected for multiple comparisons using false discovery rate control, ensuring that the expected proportion of false positives is kept below a specified threshold [19]. Subsequently, for each edge that passes this initial filter, bootstrapped mediation analysis quantifies what proportion of the relationship operates through measured intermediate proteins, complete with confidence intervals that account for the uncertainty in these estimates [22,23]. Edges are pruned only when a substantial and statistically significant proportion of the effect is mediated, with the threshold under user control to match the stringency requirements of different applications.

Additionally, by applying CausalEdge separately to time-series data from different biological conditions such as disease versus healthy states, different drug treatments, individual subjects, or distinct cell types, researchers can generate condition-specific causal networks that explicitly capture how protein regulatory roles change with context. This capability directly addresses the challenge of molecular moonlighting, where the same protein may act as a master regulator in one condition while having minimal regulatory activity in another [24,25]. Rather than averaging across contexts to produce a single "consensus" network, CausalEdge preserves these distinctions, generating structured data suitable for integration into biological knowledge graphs. Each inferred edge carries metadata indicating not just the direction and strength of the relationship, but also the specific condition under which it was observed, the temporal lag at which the effect operates, and quantified statistical confidence.

The resulting networks more accurately represent direct regulatory mechanisms, enabling improved identification of regulatory hubs—proteins that directly control many downstream targets—and regulated integration points where multiple pathways converge. By removing transitive edges that pass through intermediate proteins, network centrality measures and other topological metrics more faithfully reflect the underlying regulatory architecture rather than being inflated by indirect effects. For systems biology applications ranging from disease mechanism elucidation to therapeutic target identification, this distinction between direct and indirect relationships is not just academically interesting but practically essential. Targeting a protein with many direct regulatory connections is fundamentally different from targeting one whose apparent centrality derives primarily from being downstream of a long cascade.

## II. Methods
### 2.1 Mathematical Framework
The CausalEdge framework rests on two complementary statistical approaches: Granger causality for establishing temporal precedence and directional influence, and mediation analysis for distinguishing direct effects from those that operate through intermediate variables. Together, these methods enable inference of regulatory network structure from time-series proteomics data.

#### 2.1.1 Granger Causality Testing
The fundamental question in causal inference is whether one variable influences another. For protein time series, this translates to asking whether changes in protein A precede and help predict changes in protein B. Granger causality formalizes this intuition through a comparison of predictive models. Given time series $x_t$ and $y_t$ measured at time points $t=1,2,...T,$ we test  whether past values of $x$ improve prediciton of current values of $y$ beyond what $y$'s own history provides. This test proceeds by fitting two autoregressive models. The restricted model uses only the history of $y$ to predict it's current value:

$y_t = α_0 + \sum_{i=1}^p α_iy_{t-i}+ϵ_t$

The unrestricted model adds the history of $x$ as additional predictors:

 $y_t = α_0 + \sum_{i=1}^p α_iy_{t-i} + \sum_{i=1}^p β_ix_{t-i}+η_t$

where $p$ is the maximum lag order tested and $ϵ_t$ and $η_t$ are residual error terms. The null hypothesis that $x$ does not Granger-cause $y$ corresponds to $H_0: β_1 = β_2 = ...= β_p=0$, which is tested via an F-statistic that compares the residual variance of the two models:

$F = \frac{(RSS_r-RSS_u)/p}{RSS_u/(T-2p-1)}$

where $RSS_r$ and $RSS_u$ are the residual sums of squares for the restricted and unrestricted models, respectively. Under the null hypothesis, this statistic follows an F-distribution with degrees of freedom $(p,T-2p-1)$. A large F-statistic indicates that including $x$'s history substantially improves the prediction of $y$, suggesting a causal relationship. 

The choice of lag order $p$ is critical, as it determines how far back in time we look for predictive relationships. Too small a lag may miss regulatory effects that operate over longer timescales, while too large a lag reduces statistical power and may introduce spurious relationships. In practice, CausalEdge tests multiple lags $p[1,2,...,p_{max}]$ and selects the optimal lag, $p^*$, which is the one that yields the highest F-statistic, represetning the timescale at which the regulatory effect is strongest. This data-driven approach allows the temporal dynamics of each protein pair to emerge from the data rather than being imposed a priori.

Finally, we declare that protein X Granger-causes protein Y if the F-statistic exceeds a threshold and the associated p-value is below a significance level after correction for multiple testing (described in Section 2.1.2), establishing both temporal precedence (X's past predicts Y's future) and predictive power (the prediction is statistically significant), providing a foundation for inferring directional regulatory relationships.

#### 2.1.2 False Discovery Rate Correction
Proteomics experiments typically measure hundreds to thousands of proteins, leading to tens of thousands or even millions of potential protein pairs to test. With a standard significance threshold of $p < 0.05$, we would expect 5% of tests to yield false positives purely by chance; a problem that compounds dramatically with the number of tests performed. Without correction, networks inferred from proteomics data would be heavily contaminated with spurious edges.

To address this challenge, the Benjamini-Hochberg procedure for controlling the false discovery rate (FDR) is employed. Unlike family-wise error rate corrections such as Bonferroni, which control the probability of making any false positives, FDR correction controls the expected proportion of false positives among all rejected hypotheses. This distinction provides substantially greater statistical power while still ensuring that the majority of reported relationships are true positives.

Given $N$ candidate protein pairs tested for Granger causality, we obtain p-values $p_1, p_2 ,...,p_N$.  The Benjamini-Hochberg procedure operates as follows:
- First, sort the p-values in ascending order $p_{(1)}≤p_{(2)}≤...≤p_{(n)$.
- Second, find the largest index $k$ such thagt $p_{(k)} ≤\frac{k}{N}*α$, where $α$ is the desired FDR level (0.05 by default).
- Third, reject all null hypotheses corresponding to tests $1,2,...k$, ensuring that the  expected proportion of false positives among all rejected hypotheses is at most $α$, providing formal control over the false discovery rate while maintaining reasonable power to detect true relationships.

The importance of this correction cannot be overstated. In preliminary analyses without FDR correction, networks inferred from time-series proteomics data contained 2-10x as many edges as networks inferred with proper correction, with the additional edges showing substantially weaker effect sizes and less biological coherence. By applying FDR correction, we ensure that the networks entering the mediation analysis stage represent genuine temporal relationships rather than statistical noise.

#### 2.1.3 Mediation Analysis
Establishing that protein A Granger-causes protein C tells us that A's past helps predict C's future, but it does not tell us whether this effect is direct or mediated through intermediate proteins. This distinction is important for understanding regulatory architecture. Consider a pathway where A regulates B, and B in turn regulates C. Standard Granger causality will detect A→C (since A's past predicts C's future), but this edge is spurious in the sense that A affects C only indirectly through B. Including such indirect edges obscures the true regulatory structure and inflates centrality metrics for upstream proteins.

To address this, causal mediation analuysis is performed, which decomposes the total effect of A on C into direct and indirect components [20,21]. The total effect, denoted c
c, represents the overall influence of A on C. This can be partitioned into a direct effect $c^'$ (the influence of A on C that does not pass through any measured mediatior B) and an indirect effect $ab$ (the influence that operates through B). The indirect effect is itself a product of two paths: the effect of A on B (the "a-path") and the effect of B on C controlling for A (the "b-path"). These quantities are related by the mediation equation: 

$c=c^'+ab$

The proportion of the total effect that is mediated through B is:

$ρ = \frac{ab}{c}$

This proportion serves as our key decision variable: if a large fraction of A's effect on C operates through B, then the A→C edge should be considered indirect and removed from the network. To estimate these quantities from time-series data, three regression models are fit for each potential mediation triple (A, B, C). The first model estimates the a-path by regressing B on A and lagged values of B:

$B_t = γ_0 + \sum_{i=1}^p γ_iB_{t-i} + \sum_{i=1}^p a_iA_{t-i} + ϵ_{t}^{(1)}$

The second model estimates both the b-path and the direct effect (c'-path) by regressing C on both A and B, along with lagged values of C:

$C_t = δ_0 + \sum_{i=1}^p δ_iC_{t-i} + \sum_{i=1}^p c_{i}^' A_{t-i} + \sum_{i=1}^p b_iB_{t-i} +  ϵ_{t}^{(2)}$

The third model estimates the total effect (c-path) by regressing C on A alone:

$C_t = θ_0 \sum_{i=1}^p θ_iC_{t-i} + \sum_{i=1}^p c_iA_{t-i} +  ϵ_{t}^{(3)}$

Each path is then estiamted as the mean effect across lags $a=\frac{1}{p}\sigma_{i=1}^p a_i$, $b=\frac{1}{p}\sigma_{i=1}^p b_i$, and similarly for $c$ and $c^'$.  This averaging accounts for the fact that regulatory effects may be distributed across multiple time lags rather than concentrated at a single lag. The key quantity for determining whether an edge should be pruned is the indirect effect $ab$. However, because this is a product of two estimated coefficients, its sampling distribution is complex and typically non-normal, making standard error propagation unreliable. To obtain valid statistical inference, CasualEdge utilizes bootstrapping. 


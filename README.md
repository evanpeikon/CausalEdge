# Abstract 
Network inference from time-series proteomics data remains a challenge in systems biology, with most approaches unable to distinguish direct regulatory relationships from indirect associations mediated by intermediate proteins. CausalEdge addresses this challenge by combining Granger Causality testing with bootstrapped mediation analysis to construct directed causal networks representing direct regulatory relationships. This model operates though a four-stage pipeline: 
- First, CausalEdge performs initial filtering to find protein pairs that vary together, which narrows down candidate pairs for testing.
- Second, it performs Granger Causality tests for each candidate pair to determine if past values of Protein $A$ help predict future values of Protein $B$ better than Protein $B$'s history alone, establishing temporal precedence with false discovery rate correction.
- Third, it builds a directed network graph where proteins are represented as nodes and directed edges represent causal relationships, with edges indicating where protein A positively or negatively causally influences changes in protein $B$.
- Fourth, it performs mediation analysis to determine is observed causal relationships are mediated by another intermediate variable. For example, if protein $A$ causally influecned both protein $B$ and $C$, and protein $B$ causally influences protein $C$, it's possible that protein $A$'s effect on protein $C$ is indirect and mediated by protein $B$. In these cases, conditional Granger Causality tests are performed to assess whether the $A$→$C$ relationship becomes non-signficant when controlling for $B$, and if so, the edge between nodes $A$ and $C$ is pruned.

By quantifying the proportion of causal effect mediatd using bootstrap confidence intervals, CausalEdge provides statistically rigorous identification of spurious edges, yielding clearner, high confidence, networks that more accurately reflect direct regulatory relationships. This model is applicable to time-series proteomics data from from traditional high-throughput platforms and emerging wearable molecular biosensors, enabling more interpretable systems-level analysis of protein regulatory dynamics. An important application of CausalEdge is generating condition-specific or subject-specific causal relationship data that can be integrated into biological knowledge graphs. This capability helps address the challenge of [molecular moonlighting](https://sequenceanddestroy.substack.com/p/molecular-moonlighting), where a given protein's function depends on context, by explicitly capturing how protein regulatory roles vary across different biological states.

# I. Introduction 
## 1.1 The Challenge of Network Inference in Proteomics
Understanding causal and regulatory relationships among proteins is fundamental to systems biology, with applications ranging from disease mechanism elucidation to therapeutic target identification. While high-throughput proteomics technologies have enabled comprehensive measurement of protein abundance across conditions and time points, inferring the underlying regulatory network structure remains challenging. Traditional approaches based on correlation or differential expression analysis can identify co-varying proteins but cannot establish distinguish direct regulatory relationships from indirect associations [1,2].

The distinction between direct and indirect relationships has important implications for biological interpretation. Consider a scenario where protein A regulates protein B, and protein B in turn regulates protein C (A→B→C). Standard network inference methods would typically report edges for A→B, B→C, and A→C. However, the A→C relationship is indirect, mediated entirely through B. Including such indirect edges in network representations obscures the true regulatory architecture, complicates hub identification, and can mislead downstream pathway analysis and therapeutic targeting efforts [3,4].

A related challenge in proteomics is molecular moonlighting; the phenomenon where individual proteins perform different functions depending on cellular context, localization, post-translational modifications, or disease state [24,25]. Static protein interaction databases cannot capture this context-dependence, making it difficult to understand what a specific protein is actually doing in a particular biological condition. Condition-specific causal networks that explicitly represent how protein regulatory relationships vary across contexts provide a solution to this problem, enabling more accurate functional annotation and better integration with biological knowledge graphs.

## 1.2 Limitations of Existing Approaches 
The landscape of network inference methods reveals a persistent gap between what we can measure and what we need to understand. Static correlation-based methods, including partial correlation networks and Gaussian graphical models, excel at identifying conditional independence relationships but lack the temporal information necessary to infer directionality [5,6]. Without knowing which protein's change precedes the other, these methods cannot distinguish regulatory drivers from their downstream targets, nor can they identify mediated relationships that require temporal ordering to detect.

Differential network analysis approaches have emerged to compare networks across conditions, offering insights into context-specific associations [7]. However, these methods inherit the same causal inference limitations as their static counterparts. While they can identify which associations differ between conditions, they cannot determine whether observed changes represent direct regulatory mechanisms or merely downstream consequences of upstream perturbations. This ambiguity becomes particularly problematic when attempting to identify therapeutic targets, where distinguishing between drivers and passengers is critical.

Bayesian network approaches offer a more sophisticated framework, capable of inferring directed acyclic graphs that have been successfully applied to gene expression data [8,9]. These methods can model probabilistic dependencies and infer directionality under certain assumptions. However, most implementations do not explicitly test for or remove mediated edges, treating all inferred dependencies as equally direct. Additionally, the computational complexity of Bayesian network inference scales poorly beyond a few hundred variables, making application to proteome-scale datasets, which may include thousands of proteins, challenging. Dynamic Bayesian networks extend this framework to temporal data but rarely incorporate explicit mediation testing [10], leaving the indirect relationship problem unresolved.

Information-theoretic methods, such as mutual information and transfer entropy, provide another avenue for network inference [11,12]. These approaches can capture nonlinear relationships and infer directionality without assuming specific functional forms, making them attractive for biological systems where regulatory mechanisms may be complex. However, reliable estimation of information-theoretic quantities requires substantial amounts of data—often more than typical proteomics experiments provide. Furthermore, these methods lack straightforward frameworks for statistical significance testing and multiple comparison correction, making it difficult to distinguish true regulatory relationships from noise in finite samples. The absence of established mediation analysis procedures within the information-theoretic framework further limits their ability to identify direct relationships.

Granger causality, originally developed in econometrics and now widely used in neuroscience, offers a complementary approach based on temporal precedence and predictive power [13,14]. The core idea is as follows: if past values of variable X improve prediction of variable Y beyond what Y's own history provides, then X can be said to "Granger-cause" Y. This operational definition of causality aligns well with regulatory biology, where upstream proteins influence the abundance or activity of downstream targets over time. Despite these advantages, applications of Granger causality to proteomics have been limited [15,16], and existing implementations have not addressed the fundamental problem of indirect relationships. When protein A regulates B, and B regulates C, standard Granger causality will detect both the direct relationships (A→B, B→C) and the indirect relationship (A→C), leaving researchers with cluttered networks that obscure the true regulatory architecture.

## 1.3 Novel Contributions 
The persistent challenge of distinguishing direct from indirect relationships in protein regulatory networks motivated the development of CausalEdge, a framework that integrates Granger causality testing with bootstrapped mediation analysis to systematically identify and remove spurious edges. This integration addresses a critical gap: while Granger causality establishes temporal precedence and predictive relationships, it does not inherently distinguish whether A→C represents a direct regulatory mechanism or an indirect effect mediated through intermediate proteins. By explicitly testing for mediation and quantifying the proportion of each relationship that operates through intermediates, CausalEdge enables data-driven decisions about which edges represent direct regulatory mechanisms.

The framework makes several advances beyond existing approaches. Rather than relying on arbitrary topology-based heuristics to prune networks (such as removing edges below a certain correlation threshold or keeping only the top-k strongest relationships), CausalEdge employs statistical hypothesis testing at every stage. Initial Granger causality tests are corrected for multiple comparisons using false discovery rate control, ensuring that the expected proportion of false positives is kept below a specified threshold [19]. Subsequently, for each edge that passes this initial filter, bootstrapped mediation analysis quantifies what proportion of the relationship operates through measured intermediate proteins, complete with confidence intervals that account for the uncertainty in these estimates [22,23]. Edges are pruned only when a substantial and statistically significant proportion of the effect is mediated, with the threshold under user control to match the stringency requirements of different applications.

Additionally, by applying CausalEdge separately to time-series data from different biological conditions such as disease versus healthy states, different drug treatments, individual subjects, or distinct cell types, researchers can generate condition-specific causal networks that explicitly capture how protein regulatory roles change with context. This capability directly addresses the challenge of molecular moonlighting, where the same protein may act as a master regulator in one condition while having minimal regulatory activity in another [24,25]. Rather than averaging across contexts to produce a single "consensus" network, CausalEdge preserves these distinctions, generating structured data suitable for integration into biological knowledge graphs. Each inferred edge carries metadata indicating not just the direction and strength of the relationship, but also the specific condition under which it was observed, the temporal lag at which the effect operates, and quantified statistical confidence.

The resulting networks more accurately represent direct regulatory mechanisms, enabling improved identification of regulatory hubs—proteins that directly control many downstream targets—and regulated integration points where multiple pathways converge. By removing transitive edges that pass through intermediate proteins, network centrality measures and other topological metrics more faithfully reflect the underlying regulatory architecture rather than being inflated by indirect effects. For systems biology applications ranging from disease mechanism elucidation to therapeutic target identification, this distinction between direct and indirect relationships is not just academically interesting but practically essential. Targeting a protein with many direct regulatory connections is fundamentally different from targeting one whose apparent centrality derives primarily from being downstream of a long cascade.

# II. Methods
## 2.1 Mathematical Framework
The CausalEdge framework rests on two complementary statistical approaches: Granger causality for establishing temporal precedence and directional influence, and mediation analysis for distinguishing direct effects from those that operate through intermediate variables. Together, these methods enable inference of regulatory network structure from time-series proteomics data.

### 2.1.1 Granger Causality Testing
The fundamental question in causal inference is whether one variable influences another. For protein time series, this translates to asking whether changes in protein A precede and help predict changes in protein B. Granger causality formalizes this intuition through a comparison of predictive models. Given time series $x_t$ and $y_t$ measured at time points $t=1,2,...T,$ we test  whether past values of $x$ improve prediciton of current values of $y$ beyond what $y$'s own history provides. 
